{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "f362bf7e_6053027f",
        "filename": "suspend/1.0/default/main.cpp",
        "patchSetId": 1
      },
      "lineNbr": 130,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-04-03T00:33:54Z",
      "side": 1,
      "message": "This is kind of confusing now. WDYT:\n- set this as false\n- put conditional logic in configureRpcThreadpool instead (return if HIDL is not supported)\n- unconditionally join the AIDL thread\n\nTwo other reasons:\n- it is a device difference (however small, especially relative to not having HIDL) that the main thread is HIDL sometimes and AIDL other times. Sometimes, thread specific data can break this.\n- with the current logic, sometimes this process will have 15 threads and sometimes 16 in the AIDL threadpool, depending if the other one gets added.",
      "range": {
        "startLine": 130,
        "startChar": 30,
        "endLine": 130,
        "endChar": 55
      },
      "revId": "2ed1e2a71b80d7602a31b9048072a56639d802bd",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f01568de_d99ec452",
        "filename": "suspend/1.0/default/main.cpp",
        "patchSetId": 1
      },
      "lineNbr": 147,
      "author": {
        "id": 1644679
      },
      "writtenOn": "2024-03-27T22:38:40Z",
      "side": 1,
      "message": "@kaleshsingh@google.com 15 is the default for the max threadpool threads. Do we want to limit them for this process?",
      "range": {
        "startLine": 147,
        "startChar": 4,
        "endLine": 147,
        "endChar": 47
      },
      "revId": "2ed1e2a71b80d7602a31b9048072a56639d802bd",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7330648e_81a8a073",
        "filename": "suspend/1.0/default/main.cpp",
        "patchSetId": 1
      },
      "lineNbr": 147,
      "author": {
        "id": 1499410
      },
      "writtenOn": "2024-03-27T22:56:03Z",
      "side": 1,
      "message": "I think 8 maybe sufficient. These shouldn\u0027t be long operations unless it\u0027s blocked",
      "parentUuid": "f01568de_d99ec452",
      "range": {
        "startLine": 147,
        "startChar": 4,
        "endLine": 147,
        "endChar": 47
      },
      "revId": "2ed1e2a71b80d7602a31b9048072a56639d802bd",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c32783d4_253ec2cb",
        "filename": "suspend/1.0/default/main.cpp",
        "patchSetId": 1
      },
      "lineNbr": 147,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-04-03T00:33:54Z",
      "side": 1,
      "message": "Another thing though - these are lazy and this is a broad problem. I definitely wouldn\u0027t reduce it in the same change because it could cause a performance issue in extreme cases, and we don\u0027t have a good way to test this. If we have the API to dynamically stop threads fixed in the kernel binder driver, we could fix this across Android without having to worry about corner cases for this.",
      "parentUuid": "7330648e_81a8a073",
      "range": {
        "startLine": 147,
        "startChar": 4,
        "endLine": 147,
        "endChar": 47
      },
      "revId": "2ed1e2a71b80d7602a31b9048072a56639d802bd",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "88c78642_5c6ed08a",
        "filename": "suspend/1.0/default/main.cpp",
        "patchSetId": 1
      },
      "lineNbr": 179,
      "author": {
        "id": 1499410
      },
      "writtenOn": "2024-03-27T22:56:03Z",
      "side": 1,
      "message": "@devinmoore@google.com / @smoreland@google.com could we delete this?\n\nThis \"hal\" is really a system component (not controlled by vendor) ?",
      "range": {
        "startLine": 168,
        "startChar": 3,
        "endLine": 179,
        "endChar": 5
      },
      "revId": "2ed1e2a71b80d7602a31b9048072a56639d802bd",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ee01fb8d_4f9d51c4",
        "filename": "suspend/1.0/default/main.cpp",
        "patchSetId": 1
      },
      "lineNbr": 179,
      "author": {
        "id": 1644679
      },
      "writtenOn": "2024-03-27T23:03:46Z",
      "side": 1,
      "message": "We usually call these \"framework hals\" or \"system hals\". The system is providing this HAL for vendor processes to use (and maybe also system processes).\n\nWe can\u0027t stop providing it to vendor because they might have software that relies on it in upgrading devices. \n\nThe `max-level\u003d\"6\"` in [the manifest file](https://source.corp.google.com/h/googleplex-android/platform/superproject/main/+/main:system/hardware/interfaces/suspend/1.0/default/android.system.suspend-service.xml) means that we stop serving this HIDL interface (it fails to register here) on devices targeting VINTF level 7+ (Android T+). Once we stop supporting upgrades from devices that launched before Android T, then we can remove it. We will create a bug for it at that time.",
      "parentUuid": "88c78642_5c6ed08a",
      "range": {
        "startLine": 168,
        "startChar": 3,
        "endLine": 179,
        "endChar": 5
      },
      "revId": "2ed1e2a71b80d7602a31b9048072a56639d802bd",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}